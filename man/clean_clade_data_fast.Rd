% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/clean_clade_data_fast.R
\name{clean_clade_data_fast}
\alias{clean_clade_data_fast}
\title{Clean Clade-Level Missing Coverage (Fast Path)}
\usage{
clean_clade_data_fast(
  folder,
  min_gap_len = 500,
  min_gap_len_for_abs = 1000,
  buffered_size = c(100, 250),
  min_available_data = 0.1,
  min_clade_size = 10,
  chrom = NULL
)
}
\arguments{
\item{folder}{Character. Path to the project folder containing
\file{sister_clades.rds}, \file{gap/}, and \file{fast/} subdirectories.}

\item{min_gap_len}{Integer (bp). Minimum gap length to retain when computing
flanking-gap statistics (default: \code{500}).}

\item{min_gap_len_for_abs}{Integer (bp). Minimum flanking-gap length used to
classify a locus as absent (default: \code{1000}).}

\item{buffered_size}{Integer vector (bp). Symmetric buffer sizes applied when
recomputing flanking-gap lengths (default: \code{c(100, 250)}).}

\item{min_available_data}{Numeric in \code{[0,1]}. Minimum fraction of species
within each clade required to retain a clade-level value; entries below this
threshold are masked to \code{NA} (default: \code{0.1}).}

\item{min_clade_size}{Integer. Clades with fewer than this number of species
are exempt from \code{min_available_data} masking (default: \code{20}).}

\item{chrom}{Character vector or \code{NULL}. Chromosomes to process. If
\code{NULL}, inferred automatically from available files in \file{gap/}.}
}
\value{
Invisibly returns \code{NULL}. This function is called for side effects
(file generation).
}
\description{
Validates and processes intermediate outputs from the fast clade pipeline.
For each specified chromosome, this function filters gap intervals, computes
buffered flanking-gap lengths, detects loci with complete absence of syntenic regions,
and masks clade-level missing-coverage matrices where available data are insufficient.
}
\details{
This function assumes that the fast clade pipeline has been executed and the
following inputs are available in \code{folder}:
\itemize{
\item \file{sister_clades.rds} — a list of species grouped by clade.
\item \file{gap/CHROM.rds} — per-species \code{GRanges} objects representing
genomic gap intervals with a \code{labels} factor.
\item \file{fast/reference_anno/CHROM.rds} — reference loci per chromosome.
\item \file{fast/missing_by_clade/CHROM.rds} — clade-level missing-coverage
matrices generated by the fast pipeline.
}

For each chromosome, the function:
\enumerate{
\item Filters out short gaps (\code{width < min_gap_len}).
\item Computes flanking-gap lengths, including buffered variants.
\item Identifies loci that are completely absent across clades.
\item Applies clade-level masking based on data availability thresholds.
\item Saves the cleaned clade-level matrices to disk.
}

\strong{Outputs}
\itemize{
\item \file{fast/cleaned_missing_by_clade/CHROM.rds} — cleaned clade-level
missing-coverage matrix with low-coverage entries set to \code{NA}.
}
}
\seealso{
\code{\link{clean_clade_data_by_loci_availability_by_chrom}}
}
