% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/clean_clade_data_fast.R
\name{clean_clade_data_fast}
\alias{clean_clade_data_fast}
\title{Clean clade-level missing coverage (fast path)}
\usage{
clean_clade_data_fast(
  folder,
  min_gap_len = 500,
  min_gap_len_for_abs = 1000,
  buffered_size = c(100, 250),
  min_available_data = 0.1,
  min_clade_size = 20,
  chrom = NULL
)
}
\arguments{
\item{folder}{Character. Project folder containing \file{sister_clades.rds},
\file{gap/}, and fast outputs under \file{fast/}.}

\item{min_gap_len}{Integer (bp). Discard gap intervals shorter than this
before computing flanking-gap lengths (default \code{500}).}

\item{min_gap_len_for_abs}{Integer (bp). Threshold for calling a locus
absent using flanking gaps (default \code{1000}).}

\item{buffered_size}{Integer vector (bp). Additional symmetric buffers used
to recompute buffered flanking-gap lengths (default \code{c(100, 250)}).}

\item{min_available_data}{Numeric in \code{[0,1]}. Minimum fraction of
species per clade required to keep a clade-level value; entries with fewer
contributing species are set to \code{NA} (default \code{0.1}).}

\item{min_clade_size}{Integer. Clades with size below this threshold are
exempt from \code{min_available_data} masking (default \code{20}).}

\item{chrom}{Character vector or \code{NULL}. Chromosomes to process. If
\code{NULL}, discovered from \file{folder/gap/*.rds}.}
}
\value{
Invisibly returns \code{NULL}. Called for side effects (files written).
}
\description{
Validates inputs produced by the fast clade pipeline and, for each requested
chromosome, filters gap intervals, computes (buffered) flanking-gap lengths,
identifies loci whose entire segments are absent, and masks clade-level
missing-coverage matrices where available data are insufficient.
}
\details{
Expected fast inputs:
\itemize{
\item \file{fast/reference_anno/CHROM.rds} — per-chromosome reference loci.
\item \file{sister_clades.rds} — list of species per clade.
\item \file{gap/CHROM.rds} — per-species gap \code{GRanges} with a \code{labels} factor.
\item \file{fast/missings_by_clade/CHROM.rds} — clade-level missing coverage (as written by your pipeline).
}

Outputs:
\itemize{
\item \file{fast/cleaned_missing_by_clade/CHROM.rds} — clade-level matrix with
low-coverage clade entries masked to \code{NA}.
}
}
\seealso{
\code{\link{clean_clade_data_by_loci_availability_by_chrom}}
}
