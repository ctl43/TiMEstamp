% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/get_timepoint_fast.R
\name{get_timepoint_fast}
\alias{get_timepoint_fast}
\title{Estimate Insertion Timepoints from Clade-Level Coverage}
\usage{
get_timepoint_fast(folder, chrom = NULL)
}
\arguments{
\item{folder}{Character. Path to the project directory containing required
subdirectories: \file{fast/reference_anno/}, \file{fast/missing_by_clade/},
and optionally \file{fast/cleaned_missing_by_clade/}.}

\item{chrom}{Character vector or \code{NULL}. Chromosomes to process. If
\code{NULL}, all chromosomes are inferred automatically from
\file{gap/*.rds}.}
}
\value{
Invisibly returns \code{NULL}. A combined \code{GRanges}-like object
with predicted insertion timepoints is saved to
\file{fast/predicted_tp.rds} within \code{folder}.
}
\description{
Estimates the evolutionary insertion timing of reference loci based on
clade-level coverage patterns. The function integrates per-chromosome
reference annotations with cleaned or raw missing-coverage matrices to infer
the earliest clade in which each locus is present.
}
\details{
The function reads chromosome-specific reference annotations and corresponding
clade-level coverage matrices. If cleaned coverage data are available under
\file{fast/cleaned_missing_by_clade/}, they are used preferentially; otherwise,
the raw matrices in \file{fast/missing_by_clade/} are used with a warning.

For each chromosome:
\enumerate{
\item Load the reference loci from \file{fast/reference_anno/CHROM.rds}.
\item Load the corresponding clade-level coverage matrix from
\file{fast/cleaned_missing_by_clade/CHROM.rds} or
\file{fast/missing_by_clade/CHROM.rds}.
\item Predict the earliest clade of presence for each locus using
\code{predict_timepoint()}.
\item Append the predicted values to the reference object as a
\code{timepoint} column.
}

The merged results across chromosomes are saved as
\file{fast/predicted_tp.rds}, which contains a combined object (typically a
\code{GRanges}) with a \code{timepoint} factor column indicating the inferred
insertion clade index.
}
\examples{
\dontrun{
# Estimate insertion timepoints across all chromosomes
get_timepoint_fast(folder = "results/mammals_project")
}

}
\seealso{
\code{\link{get_missing_by_clades_fast}},
\code{\link{clean_clade_data_fast}},
\code{\link{predict_timepoint}}
}
