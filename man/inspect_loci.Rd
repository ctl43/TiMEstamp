% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/inspect_loci.R
\name{inspect_loci}
\alias{inspect_loci}
\title{Inspect missing loci across multiple chromosomes}
\usage{
inspect_loci(
  folder,
  selected_info = "fivep_frag",
  min_gap_len_for_abs = 1000L,
  chrom = NULL,
  which_side = "upstream",
  buffered_size = c(100, 250)
)
}
\arguments{
\item{folder}{Character string. Path to the project folder containing
required subdirectories such as \code{gap/} and \code{processed/}.}

\item{selected_info}{Character or \code{NULL}. If not \code{NULL}, specifies
which metadata column of \code{reference_anno} to use as annotation.
If \code{NULL}, the \code{GRanges/GRangesList} object itself is used.}

\item{min_gap_len_for_abs}{Integer scalar (default \code{1000L}).
Minimum flanking gap length (in base pairs) used to classify loci as absent.}

\item{chrom}{Character vector or \code{NULL}. Names of chromosomes to process.
If \code{NULL}, chromosomes are automatically discovered from filenames
under \code{folder/gap}.}

\item{which_side}{Character string specifying which flanking side(s)
should determine absence calls for the locus.
Must be one of \code{"upstream"}, \code{"downstream"}, or \code{"both"}.
\itemize{
\item \code{"upstream"}: absence is called if the upstream flank is missing.
\item \code{"downstream"}: absence is called if the downstream flank is missing.
\item \code{"both"}: absence is called only if both flanks are missing.
}}

\item{buffered_size}{Integer vector (default \code{c(100, 250)}). Additional
buffer sizes (in base pairs) to use when computing buffered flanking gap lengths.}
}
\value{
Invisibly returns \code{NULL}. As a side effect, calls
\code{inspect_loci_by_chrom} for each chromosome, which saves
multiple RDS files to the \code{processed/} subdirectory of \code{folder}.
}
\description{
This function is a wrapper that iterates over chromosomes in a project
folder and calls \code{inspect_loci_by_chrom} for each one. It checks for
the presence of sister-clade information, discovers chromosomes to process
if none are explicitly provided, and passes parameters downstream.
}
\details{
Inputs expected in \file{folder}:
\itemize{
\item \file{processed/reference_anno/CHROM.rds}: per-locus reference annotation (GRanges/GRangesList).
\item \file{sister_clades.rds}: named list of character vectors defining sister clades.
\item \file{gap/CHROM.rds}: per-species gap GRanges for missing alignment segments.
\item \file{processed/missing_portion/CHROM.rds}: numeric matrix of missing fractions per locus by species.
}

Files written to \file{folder/processed/}:
\itemize{
\item \file{flanking_gap_len/CHROM.rds}: data.frame of unbuffered flanking gap lengths (\code{up}, \code{dn}).
\item \file{cladewise_existence/CHROM.rds}: integer matrix of clade-level existence calls (1 present, 0 absent, -1 uncertain).
\item \file{loci_existence/CHROM.rds}: integer matrix of species-level existence after applying clade masks; \code{-2} marks loci missing the whole segment by flank rule.
\item \file{cleaned_missing_portion/CHROM.rds}: missing-fraction matrix with \code{NA} at loci called absent by flank rule.
\item \file{cleaned_missing_by_clade/CHROM.rds}: row means of cleaned missing fractions aggregated by clade.
\item \file{is_cladewise_unreliable/CHROM.rds}: logical vector flagging loci with inconsistency between clade-level absence and species-level evidence.
}
}
