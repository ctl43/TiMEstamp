% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/extract_fasta_gaps_to_bed.R
\name{extract_gaps_from_fasta}
\alias{extract_gaps_from_fasta}
\title{Extract gap runs from per-species FASTA files and write BED tracks per chromosome}
\usage{
extract_gaps_from_fasta(folder, threads = 1L)
}
\arguments{
\item{folder}{Character scalar. Project root directory that contains a
\verb{fasta/} subdirectory with one subfolder per chromosome as produced by
\code{convert_maf_to_fasta()}.}

\item{threads}{Integer scalar. Number of worker processes for parallel
execution. Default is \code{1L} for serial execution.}
}
\value{
Invisibly returns the vector of BED output file paths (one per chromosome).
}
\description{
Given a project \code{folder} that contains FASTA outputs produced by
\code{convert_maf_to_fasta()}, this function scans each chromosome subfolder under
\verb{folder/fasta/}, detects contiguous gap runs (\code{-}) in each FASTA, and writes
one BED file per chromosome into \verb{folder/gap_bed/}. The BED files contain
0-based, half-open intervals of gap segments and include the FASTA filename
(species_tag) in the fourth column for provenance.
}
\details{
\strong{Expected input layout}

\if{html}{\out{<div class="sourceCode">}}\preformatted{<folder>/
  fasta/
    chr1/
      hg38.fa
      panTro6.fa
      gorGor6.fa
      ...
    chr2/
      ...
    chr22/
      ...
}\if{html}{\out{</div>}}

Each FASTA file contains a single record whose header is the reference
chromosome name (for example \verb{>chr22}) and the sequence is the per-species
alignment string where unaligned positions are represented by \code{-}.

\strong{Outputs}

For each \verb{fasta/<chrom>/} subfolder, a BED file named \verb{<chrom>.bed} is
written to \verb{folder/gap_bed/}. Each BED row has four fields:
\enumerate{
\item \code{chrom}: chromosome name taken from the FASTA header
\item \code{start}: 0-based start coordinate of the gap run
\item \code{end}: 0-based end coordinate (half-open)
\item \code{name}: FASTA file basename without extension (species tag)
}

Gap detection is performed by the compiled helper \code{cxx_fasta_gaps_to_bed()},
which scans the sequences and emits gap intervals. By default, gaps of length
at least 10 bp are reported; adjust this threshold by passing
\code{min_gap_inclusive} to the C++ helper if needed.

\strong{Parallelization}

Chromosome subfolders are processed in parallel with \code{BiocParallel::bpmapply}
using a \code{SnowParam} backend.
}
\section{Requirements}{

\itemize{
\item The C++ routine \code{cxx_fasta_gaps_to_bed(fasta_files, bed_out, min_gap_inclusive)}
must be available in the session (for example via \code{Rcpp::sourceCpp()}).
\item FASTA files must contain the reference chromosome in the header and use
\code{-} to indicate gaps.
}
}

\examples{
\dontrun{
# Process gap tracks for all chromosomes under <folder>/fasta
extract_fasta_gaps_to_bed("path/to/project", threads = 4L)
}

}
\seealso{
\code{convert_maf_to_fasta()} for generating the per-species FASTA inputs;
\code{BiocParallel::bpmapply()}, \code{BiocParallel::SnowParam()}.
}
