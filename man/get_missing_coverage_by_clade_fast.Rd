% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/get_missing_coverage_by_clade_fast.R
\name{get_missing_coverage_by_clade_fast}
\alias{get_missing_coverage_by_clade_fast}
\title{Fast clade-level missing coverage}
\usage{
get_missing_coverage_by_clade_fast(folder, reference_file = NULL, chrom = NULL)
}
\arguments{
\item{folder}{Character scalar. Project folder containing \file{gap/} and
\file{sister_clades.rds}; outputs are written to \file{fast/}.}

\item{reference_file}{Character or \code{NULL}. Path to an RDS reference
annotation. If \code{NULL}, defaults to \file{folder/rmsk_range.rds}.
The object can be a \code{GRanges} or a \code{GRangesList} with a
\code{$members} column (see Details).}

\item{chrom}{Character vector or \code{NULL}. Chromosomes to process.
If \code{NULL}, discovered from \file{folder/gap/*.rds}.}
}
\value{
Invisibly returns \code{NULL}. Called for its side effects of creating
the files listed above.
}
\description{
Computes missing coverage per clade for selected chromosomes using
run-length coverage of per-species gap intervals. If \code{reference_file}
is not provided, a default \file{rmsk_range.rds} is used from \code{folder}.
Results are written under \file{fast/}.
}
\details{
\strong{Inputs expected in \code{folder}:}
\itemize{
\item \file{sister_clades.rds}: list of character vectors of species per clade.
\item \file{gap/CHROM.rds}: per-species gap \code{GRanges} with a factor
column \code{labels} for species.
\item \file{rmsk_range.rds} (optional): default reference if \code{reference_file} is \code{NULL}.
}

\strong{Reference structure:}
\itemize{
\item If the reference has a metadata column \code{$members} with a
\code{GRangesList}, coverage is summed per member and then per locus.
\item Otherwise a plain \code{GRanges} is used and coverage is summed per locus.
}

\strong{Outputs written by the worker:}
\itemize{
\item \file{fast/reference_anno/CHROM.rds}: per-chromosome subset of \code{reference_anno}.
\item \file{fast/missing_by_clade/CHROM.rds}: numeric matrix (loci Ã— clades)
of missing coverage fractions in [0,1].
}
}
\examples{
\dontrun{
get_missing_coverage_by_clade_fast(folder = "proj")
get_missing_coverage_by_clade_fast(folder = "proj",
  reference_file = "proj/rmsk_range.rds", chrom = c("chr1","chr2"))
}

}
\seealso{
\code{\link{get_missing_coverage_by_chrom}}
}
