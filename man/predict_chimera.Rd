% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/predict_chimera.R
\name{predict_chimera}
\alias{predict_chimera}
\title{Predict chimeric insertions}
\usage{
predict_chimera(
  folder,
  chrom = NULL,
  which_side = "upstream",
  min_len = 25,
  max_len = 1000,
  min_cov = 0.65,
  min_supporting = 15L
)
}
\arguments{
\item{folder}{Character scalar. Project folder containing required inputs and
where outputs will be written under \file{processed/}.}

\item{chrom}{Character vector or \code{NULL}. Chromosomes to process. If
\code{NULL}, discovered from \file{folder/gap} by stripping the \code{.rds} suffix.}

\item{which_side}{Character; \code{"upstream"} or \code{"downstream"} to choose
the 5' or 3' flank, respectively. Default \code{"upstream"}.}

\item{min_len}{Integer (bp). Minimum representative flank length to consider
as a candidate segment. Default \code{25}.}

\item{max_len}{Integer (bp). Maximum representative flank length to consider.
Default \code{1000}. (Current implementation stops if \code{max_len} is below
\code{1000} and if \code{max_len \le min_len}.)}

\item{min_cov}{Numeric in \code{[0,1]}. Minimum clade-level coverage agreement
(converted internally to a missingness cutoff as \code{1 - min_cov}) used by
\code{predict_timepoint()}. Default \code{0.65}.}

\item{min_supporting}{Integer. Minimum total count of supporting segments
across clusters (after filtering) required to call a locus. Default \code{15L}.}
}
\value{
Invisibly returns \code{NULL}. Called for its side effects (files written).
}
\description{
For each selected chromosome, predicts loci with putative chimeric insertions
by comparing the inferred timepoint of the locus to the timepoint
inferred from its flanking segments, and by requiring consistent support from
segment clusters and clade-level reliability filters.
}
\details{
\strong{Inputs expected (created by earlier steps):}
\itemize{
\item \file{processed/cleaned_missing_by_clade/CHROM.rds} — clade-wise missing fractions for loci.
\item \file{processed/flanking_rep_len/CHROM.rds} — representative flank lengths and clustering metadata.
\item \file{processed/cleaned_flanking_seg_missing_by_clade/CHROM.rds} — clade-wise missing fractions for flanking segments.
\item \file{processed/flanking_seg_grp/CHROM.rds} — factor mapping segment rows to parent loci.
\item \file{processed/flanking_seg_is_cladewise_unreliable/CHROM.rds} — segment-level reliability flags.
\item \file{processed/is_cladewise_unreliable/CHROM.rds} — locus-level reliability flags.
\item \file{processed/reference_anno/CHROM.rds} — per-chromosome reference loci.
}

\strong{Outputs:}
\itemize{
\item \file{processed/predicted_chimera_<which_side>/CHROM.rds} — a subset of
\code{reference_anno} with additional fields for predicted flanking
coordinates (\code{$flanking_gcoord}) and combined locus range
(\code{$full_range}) for passed loci.
}

The function validates basic parameter constraints (e.g., \code{min_len > 10},
\code{max_len} not below \code{1000}, and \code{max_len > min_len}).
}
\seealso{
\code{\link{extract_flanking_segment}}, \code{\link{predict_timepoint}}
}
